<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Orders Management - Admin Dashboard</title>

    <!-- Custom fonts for this template-->
    <link href="vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i" rel="stylesheet">

    <!-- Custom styles for this template-->
    <link href="css/sb-admin-2.min.css" rel="stylesheet">

    <style>
        .status-badge {
            font-size: 0.75rem;
            padding: 0.25rem 0.5rem;
        }
        .delivery-mode-badge {
            font-size: 0.7rem;
            padding: 0.2rem 0.4rem;
        }
        .table-actions .btn {
            padding: 0.25rem 0.5rem;
            font-size: 0.75rem;
            margin-right: 0.25rem;
        }
        .order-details-section {
            border-left: 4px solid #4e73df;
            padding-left: 1rem;
            margin-bottom: 1.5rem;
        }
        .filter-section {
            background-color: #f8f9fc;
            border-radius: 0.35rem;
            padding: 1rem;
            margin-bottom: 1.5rem;
        }
        .pagination-info {
            color: #858796;
            font-size: 0.875rem;
        }
    </style>
</head>

<body id="page-top">

    <!-- Page Wrapper -->
    <div id="wrapper">

        <!-- Sidebar -->
        <ul class="navbar-nav bg-gradient-primary sidebar sidebar-dark accordion" id="accordionSidebar">

            <!-- Sidebar - Brand -->
            <a class="sidebar-brand d-flex align-items-center justify-content-center" href="index.html">
                <div class="sidebar-brand-icon rotate-n-15">
                    <i class="fas fa-laugh-wink"></i>
                </div>
                <div class="sidebar-brand-text mx-3">SB Admin <sup>2</sup></div>
            </a>

            <!-- Divider -->
            <hr class="sidebar-divider my-0">

            <!-- Nav Item - Dashboard -->
            <li class="nav-item">
                <a class="nav-link" href="index.html">
                    <i class="fas fa-fw fa-tachometer-alt"></i>
                    <span>Dashboard</span></a>
            </li>

            <!-- Divider -->
            <hr class="sidebar-divider">

            <!-- Heading -->
            <div class="sidebar-heading">
                Interface
            </div>

            <!-- Nav Item - Pages Collapse Menu -->
            <li class="nav-item">
                <a class="nav-link collapsed" href="#" data-toggle="collapse" data-target="#collapseTwo"
                    aria-expanded="true" aria-controls="collapseTwo">
                    <i class="fas fa-fw fa-cog"></i>
                    <span>Components</span>
                </a>
                <div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#accordionSidebar">
                    <div class="bg-white py-2 collapse-inner rounded">
                        <h6 class="collapse-header">Custom Components:</h6>
                        <a class="collapse-item" href="buttons.html">Buttons</a>
                        <a class="collapse-item" href="cards.html">Cards</a>
                    </div>
                </div>
            </li>

            <!-- Nav Item - Utilities Collapse Menu -->
            <li class="nav-item">
                <a class="nav-link collapsed" href="#" data-toggle="collapse" data-target="#collapseUtilities"
                    aria-expanded="true" aria-controls="collapseUtilities">
                    <i class="fas fa-fw fa-wrench"></i>
                    <span>Utilities</span>
                </a>
                <div id="collapseUtilities" class="collapse" aria-labelledby="headingUtilities"
                    data-parent="#accordionSidebar">
                    <div class="bg-white py-2 collapse-inner rounded">
                        <h6 class="collapse-header">Custom Utilities:</h6>
                        <a class="collapse-item" href="utilities-color.html">Colors</a>
                        <a class="collapse-item" href="utilities-border.html">Borders</a>
                        <a class="collapse-item" href="utilities-animation.html">Animations</a>
                        <a class="collapse-item" href="utilities-other.html">Other</a>
                    </div>
                </div>
            </li>

            <!-- Divider -->
            <hr class="sidebar-divider">

            <!-- Heading -->
            <div class="sidebar-heading">
                Addons
            </div>

            <!-- Nav Item - Pages Collapse Menu -->
            <li class="nav-item">
                <a class="nav-link collapsed" href="#" data-toggle="collapse" data-target="#collapsePages"
                    aria-expanded="true" aria-controls="collapsePages">
                    <i class="fas fa-fw fa-folder"></i>
                    <span>Pages</span>
                </a>
                <div id="collapsePages" class="collapse" aria-labelledby="headingPages" data-parent="#accordionSidebar">
                    <div class="bg-white py-2 collapse-inner rounded">
                        <h6 class="collapse-header">Login Screens:</h6>
                        <a class="collapse-item" href="login.html">Login</a>
                        <a class="collapse-item" href="register.html">Register</a>
                        <a class="collapse-item" href="forgot-password.html">Forgot Password</a>
                        <div class="collapse-divider"></div>
                        <h6 class="collapse-header">Other Pages:</h6>
                        <a class="collapse-item" href="404.html">404 Page</a>
                        <a class="collapse-item" href="blank.html">Blank Page</a>
                    </div>
                </div>
            </li>

            <!-- Nav Item - Orders -->
            <li class="nav-item active">
                <a class="nav-link" href="orders.html">
                    <i class="fas fa-fw fa-shopping-cart"></i>
                    <span>Orders</span></a>
            </li>

            <!-- Nav Item - Charts -->
            <li class="nav-item">
                <a class="nav-link" href="charts.html">
                    <i class="fas fa-fw fa-chart-area"></i>
                    <span>Charts</span></a>
            </li>

            <!-- Nav Item - Tables -->
            <li class="nav-item">
                <a class="nav-link" href="tables.html">
                    <i class="fas fa-fw fa-table"></i>
                    <span>Tables</span></a>
            </li>

            <!-- Divider -->
            <hr class="sidebar-divider d-none d-md-block">

            <!-- Sidebar Toggler (Sidebar) -->
            <div class="text-center d-none d-md-inline">
                <button class="rounded-circle border-0" id="sidebarToggle"></button>
            </div>

            <!-- Sidebar Message -->
            <div class="sidebar-card d-none d-lg-flex">
                <img class="sidebar-card-illustration mb-2" src="img/undraw_rocket.svg" alt="...">
                <p class="text-center mb-2"><strong>SB Admin Pro</strong> is packed with premium features, components, and more!</p>
                <a class="btn btn-success btn-sm" href="https://startbootstrap.com/theme/sb-admin-pro">Upgrade to Pro!</a>
            </div>

        </ul>
        <!-- End of Sidebar -->

        <!-- Content Wrapper -->
        <div id="content-wrapper" class="d-flex flex-column">

            <!-- Main Content -->
            <div id="content">

                <!-- Topbar -->
                <nav class="navbar navbar-expand navbar-light bg-white topbar mb-4 static-top shadow">

                    <!-- Sidebar Toggle (Topbar) -->
                    <button id="sidebarToggleTop" class="btn btn-link d-md-none rounded-circle mr-3">
                        <i class="fa fa-bars"></i>
                    </button>

                    <!-- Topbar Search -->
                    <form class="d-none d-sm-inline-block form-inline mr-auto ml-md-3 my-2 my-md-0 mw-100 navbar-search">
                        <div class="input-group">
                            <input type="text" class="form-control bg-light border-0 small" placeholder="Search for..."
                                aria-label="Search" aria-describedby="basic-addon2">
                            <div class="input-group-append">
                                <button class="btn btn-primary" type="button">
                                    <i class="fas fa-search fa-sm"></i>
                                </button>
                            </div>
                        </div>
                    </form>

                    <!-- Topbar Navbar -->
                    <ul class="navbar-nav ml-auto">

                        <!-- Nav Item - Alerts -->
                        <li class="nav-item dropdown no-arrow mx-1">
                            <a class="nav-link dropdown-toggle" href="#" id="alertsDropdown" role="button"
                                data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <i class="fas fa-bell fa-fw"></i>
                                <span class="badge badge-danger badge-counter">3+</span>
                            </a>
                        </li>

                        <!-- Nav Item - Messages -->
                        <li class="nav-item dropdown no-arrow mx-1">
                            <a class="nav-link dropdown-toggle" href="#" id="messagesDropdown" role="button"
                                data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <i class="fas fa-envelope fa-fw"></i>
                                <span class="badge badge-danger badge-counter">7</span>
                            </a>
                        </li>

                        <div class="topbar-divider d-none d-sm-block"></div>

                        <!-- Nav Item - User Information -->
                        <li class="nav-item dropdown no-arrow">
                            <a class="nav-link dropdown-toggle" href="#" id="userDropdown" role="button"
                                data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <span class="mr-2 d-none d-lg-inline text-gray-600 small">Douglas McGee</span>
                                <img class="img-profile rounded-circle" src="img/undraw_profile.svg">
                            </a>
                        </li>

                    </ul>

                </nav>
                <!-- End of Topbar -->

                <!-- Begin Page Content -->
                <div class="container-fluid">

                    <!-- Page Heading -->
                    <div class="d-sm-flex align-items-center justify-content-between mb-4">
                        <h1 class="h3 mb-0 text-gray-800">Orders Management</h1>
                        <a href="#" class="d-none d-sm-inline-block btn btn-sm btn-primary shadow-sm">
                            <i class="fas fa-download fa-sm text-white-50"></i> Export Orders
                        </a>
                    </div>

                    <!-- Filters Section -->
                    <div class="filter-section">
                        <div class="row">
                            <div class="col-md-4">
                                <label for="searchInput" class="form-label">Search Orders</label>
                                <input type="text" class="form-control" id="searchInput" placeholder="Order ID, Customer Name, Email, Project...">
                            </div>
                            <div class="col-md-3">
                                <label for="statusFilter" class="form-label">Filter by Status</label>
                                <select class="form-control" id="statusFilter">
                                    <option value="">All Status</option>
                                    <option value="pending">Pending</option>
                                    <option value="processing">Processing</option>
                                    <option value="shipped">Shipped</option>
                                    <option value="completed">Completed</option>
                                    <option value="cancelled">Cancelled</option>
                                </select>
                            </div>
                            <div class="col-md-3">
                                <label for="deliveryFilter" class="form-label">Filter by Delivery</label>
                                <select class="form-control" id="deliveryFilter">
                                    <option value="">All Delivery Modes</option>
                                    <option value="download">Download</option>
                                    <option value="pendrive">Pen Drive</option>
                                </select>
                            </div>
                            <div class="col-md-2 d-flex align-items-end">
                                <button class="btn btn-outline-secondary btn-block" onclick="clearFilters()">
                                    <i class="fas fa-times"></i> Clear
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Orders Table -->
                    <div class="card shadow mb-4">
                        <div class="card-header py-3">
                            <h6 class="m-0 font-weight-bold text-primary">Orders List</h6>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-bordered" id="ordersTable" width="100%" cellspacing="0">
                                    <thead>
                                        <tr>
                                            <th>Order ID</th>
                                            <th>Customer</th>
                                            <th>Project Title</th>
                                            <th>Contact</th>
                                            <th>Order Date</th>
                                            <th>Delivery Mode</th>
                                            <th>Status</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="ordersTableBody">
                                        <!-- Orders will be populated here by JavaScript -->
                                    </tbody>
                                </table>
                            </div>
                            
                            <!-- Pagination -->
                            <div class="row">
                                <div class="col-sm-12 col-md-5">
                                    <div class="pagination-info" id="paginationInfo">
                                        Showing 1 to 10 of 25 entries
                                    </div>
                                </div>
                                <div class="col-sm-12 col-md-7">
                                    <div class="pagination-wrapper float-right">
                                        <nav aria-label="Page navigation">
                                            <ul class="pagination pagination-sm" id="pagination">
                                                <li class="page-item disabled">
                                                    <a class="page-link" href="#" onclick="changePage(currentPage - 1)">Previous</a>
                                                </li>
                                                <li class="page-item active">
                                                    <a class="page-link" href="#" onclick="changePage(1)">1</a>
                                                </li>
                                                <li class="page-item">
                                                    <a class="page-link" href="#" onclick="changePage(2)">2</a>
                                                </li>
                                                <li class="page-item">
                                                    <a class="page-link" href="#" onclick="changePage(3)">3</a>
                                                </li>
                                                <li class="page-item">
                                                    <a class="page-link" href="#" onclick="changePage(currentPage + 1)">Next</a>
                                                </li>
                                            </ul>
                                        </nav>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
                <!-- /.container-fluid -->

            </div>
            <!-- End of Main Content -->

            <!-- Footer -->
            <footer class="sticky-footer bg-white">
                <div class="container my-auto">
                    <div class="copyright text-center my-auto">
                        <span>Copyright &copy; Your Website 2021</span>
                    </div>
                </div>
            </footer>
            <!-- End of Footer -->

        </div>
        <!-- End of Content Wrapper -->

    </div>
    <!-- End of Page Wrapper -->

    <!-- Order Details Modal -->
    <div class="modal fade" id="orderDetailsModal" tabindex="-1" role="dialog" aria-labelledby="orderDetailsModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="orderDetailsModalLabel">Order Details</h5>
                    <button class="close" type="button" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">×</span>
                    </button>
                </div>
                <div class="modal-body" id="orderDetailsBody">
                    <!-- Order details will be populated here -->
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" type="button" data-dismiss="modal">Close</button>
                    <button class="btn btn-primary" type="button" onclick="updateOrderStatus()">Update Status</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Delivery Management Modal -->
    <div class="modal fade" id="deliveryModal" tabindex="-1" role="dialog" aria-labelledby="deliveryModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="deliveryModalLabel">Manage Delivery</h5>
                    <button class="close" type="button" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">×</span>
                    </button>
                </div>
                <div class="modal-body" id="deliveryModalBody">
                    <!-- Delivery management content will be populated here -->
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" type="button" data-dismiss="modal">Close</button>
                    <button class="btn btn-primary" type="button" onclick="saveDeliveryDetails()">Save Changes</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scroll to Top Button-->
    <a class="scroll-to-top rounded" href="#page-top">
        <i class="fas fa-angle-up"></i>
    </a>

    <!-- Bootstrap core JavaScript-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/4.6.0/js/bootstrap.bundle.min.js"></script>

    <!-- Core plugin JavaScript-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.4.1/jquery.easing.min.js"></script>

    <script>
        // Sample orders data
        let orders = [
            {
                id: 'ORD-001',
                customerName: 'John Smith',
                email: 'john@example.com',
                phone: '+1-555-0123',
                projectTitle: 'E-Commerce Website with React',
                price: 299.99,
                orderDate: '2024-01-15',
                deliveryMode: 'download',
                status: 'completed',
                downloadLink: 'https://example.com/download/project1',
                linkSent: true,
                adminNotes: 'Customer requested additional documentation'
            },
            {
                id: 'ORD-002',
                customerName: 'Sarah Johnson',
                email: 'sarah@example.com',
                phone: '+1-555-0124',
                projectTitle: 'Inventory Management System',
                price: 199.99,
                orderDate: '2024-01-16',
                deliveryMode: 'pendrive',
                status: 'shipped',
                trackingId: 'TRK123456789',
                courierName: 'FedEx',
                dispatchDate: '2024-01-18',
                adminNotes: 'Special packaging requested'
            },
            {
                id: 'ORD-003',
                customerName: 'Mike Wilson',
                email: 'mike@example.com',
                phone: '+1-555-0125',
                projectTitle: 'Student Management System',
                price: 149.99,
                orderDate: '2024-01-17',
                deliveryMode: 'download',
                status: 'processing',
                downloadLink: '',
                linkSent: false,
                adminNotes: ''
            },
            {
                id: 'ORD-004',
                customerName: 'Emily Davis',
                email: 'emily@example.com',
                phone: '+1-555-0126',
                projectTitle: 'Hospital Management System',
                price: 399.99,
                orderDate: '2024-01-18',
                deliveryMode: 'pendrive',
                status: 'pending',
                trackingId: '',
                courierName: '',
                dispatchDate: '',
                adminNotes: 'Priority order - handle ASAP'
            },
            {
                id: 'ORD-005',
                customerName: 'David Brown',
                email: 'david@example.com',
                phone: '+1-555-0127',
                projectTitle: 'Chat Application with Node.js',
                price: 179.99,
                orderDate: '2024-01-19',
                deliveryMode: 'download',
                status: 'cancelled',
                downloadLink: '',
                linkSent: false,
                adminNotes: 'Customer requested refund'
            }
        ];

        let currentPage = 1;
        let ordersPerPage = 10;
        let filteredOrders = [...orders];

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            renderOrders();
            setupEventListeners();
        });

        function setupEventListeners() {
            document.getElementById('searchInput').addEventListener('input', filterOrders);
            document.getElementById('statusFilter').addEventListener('change', filterOrders);
            document.getElementById('deliveryFilter').addEventListener('change', filterOrders);
        }

        function renderOrders() {
            const tbody = document.getElementById('ordersTableBody');
            const startIndex = (currentPage - 1) * ordersPerPage;
            const endIndex = startIndex + ordersPerPage;
            const ordersToShow = filteredOrders.slice(startIndex, endIndex);

            tbody.innerHTML = '';

            ordersToShow.forEach(order => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td><strong>${order.id}</strong></td>
                    <td>
                        <div>${order.customerName}</div>
                        <small class="text-muted">${order.email}</small>
                    </td>
                    <td>
                        <div class="text-truncate" style="max-width: 200px;" title="${order.projectTitle}">
                            ${order.projectTitle}
                        </div>
                        <small class="text-success">$${order.price}</small>
                    </td>
                    <td>
                        <div>${order.phone}</div>
                        <small class="text-muted">${order.email}</small>
                    </td>
                    <td>${formatDate(order.orderDate)}</td>
                    <td>
                        <span class="badge delivery-mode-badge ${order.deliveryMode === 'download' ? 'badge-info' : 'badge-warning'}">
                            ${order.deliveryMode === 'download' ? 'Download' : 'Pen Drive'}
                        </span>
                    </td>
                    <td>
                        <span class="badge status-badge ${getStatusBadgeClass(order.status)}">
                            ${order.status.charAt(0).toUpperCase() + order.status.slice(1)}
                        </span>
                    </td>
                    <td class="table-actions">
                        <button class="btn btn-info btn-sm" onclick="viewOrderDetails('${order.id}')">
                            <i class="fas fa-eye"></i>
                        </button>
                        <button class="btn btn-primary btn-sm" onclick="manageDelivery('${order.id}')">
                            <i class="fas fa-truck"></i>
                        </button>
                        <button class="btn btn-success btn-sm" onclick="updateStatus('${order.id}')">
                            <i class="fas fa-edit"></i>
                        </button>
                    </td>
                `;
                tbody.appendChild(row);
            });

            updatePaginationInfo();
        }

        function getStatusBadgeClass(status) {
            const statusClasses = {
                'pending': 'badge-warning',
                'processing': 'badge-info',
                'shipped': 'badge-primary',
                'completed': 'badge-success',
                'cancelled': 'badge-danger'
            };
            return statusClasses[status] || 'badge-secondary';
        }

        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('en-US', { 
                year: 'numeric', 
                month: 'short', 
                day: 'numeric' 
            });
        }

        function filterOrders() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const statusFilter = document.getElementById('statusFilter').value;
            const deliveryFilter = document.getElementById('deliveryFilter').value;

            filteredOrders = orders.filter(order => {
                const matchesSearch = !searchTerm || 
                    order.id.toLowerCase().includes(searchTerm) ||
                    order.customerName.toLowerCase().includes(searchTerm) ||
                    order.email.toLowerCase().includes(searchTerm) ||
                    order.projectTitle.toLowerCase().includes(searchTerm);

                const matchesStatus = !statusFilter || order.status === statusFilter;
                const matchesDelivery = !deliveryFilter || order.deliveryMode === deliveryFilter;

                return matchesSearch && matchesStatus && matchesDelivery;
            });

            currentPage = 1;
            renderOrders();
        }

        function clearFilters() {
            document.getElementById('searchInput').value = '';
            document.getElementById('statusFilter').value = '';
            document.getElementById('deliveryFilter').value = '';
            filteredOrders = [...orders];
            currentPage = 1;
            renderOrders();
        }

        function viewOrderDetails(orderId) {
            const order = orders.find(o => o.id === orderId);
            if (!order) return;

            const modalBody = document.getElementById('orderDetailsBody');
            modalBody.innerHTML = `
                <div class="order-details-section">
                    <h6 class="text-primary">Order Information</h6>
                    <div class="row">
                        <div class="col-md-6">
                            <p><strong>Order ID:</strong> ${order.id}</p>
                            <p><strong>Order Date:</strong> ${formatDate(order.orderDate)}</p>
                            <p><strong>Status:</strong> 
                                <span class="badge ${getStatusBadgeClass(order.status)}">
                                    ${order.status.charAt(0).toUpperCase() + order.status.slice(1)}
                                </span>
                            </p>
                        </div>
                        <div class="col-md-6">
                            <p><strong>Project:</strong> ${order.projectTitle}</p>
                            <p><strong>Price:</strong> $${order.price}</p>
                            <p><strong>Delivery Mode:</strong> ${order.deliveryMode === 'download' ? 'Download' : 'Pen Drive'}</p>
                        </div>
                    </div>
                </div>

                <div class="order-details-section">
                    <h6 class="text-primary">Customer Information</h6>
                    <div class="row">
                        <div class="col-md-6">
                            <p><strong>Name:</strong> ${order.customerName}</p>
                            <p><strong>Email:</strong> ${order.email}</p>
                        </div>
                        <div class="col-md-6">
                            <p><strong>Phone:</strong> ${order.phone}</p>
                        </div>
                    </div>
                </div>

                <div class="order-details-section">
                    <h6 class="text-primary">Delivery Details</h6>
                    ${order.deliveryMode === 'download' ? 
                        `<p><strong>Download Link:</strong> ${order.downloadLink || 'Not generated'}</p>
                         <p><strong>Link Status:</strong> ${order.linkSent ? 'Sent' : 'Pending'}</p>` :
                        `<p><strong>Tracking ID:</strong> ${order.trackingId || 'Not assigned'}</p>
                         <p><strong>Courier:</strong> ${order.courierName || 'Not assigned'}</p>
                         <p><strong>Dispatch Date:</strong> ${order.dispatchDate ? formatDate(order.dispatchDate) : 'Not dispatched'}</p>`
                    }
                </div>

                <div class="order-details-section">
                    <h6 class="text-primary">Admin Notes</h6>
                    <p>${order.adminNotes || 'No notes available'}</p>
                    <textarea class="form-control" id="adminNotesTextarea" rows="3" placeholder="Add admin notes...">${order.adminNotes || ''}</textarea>
                </div>
            `;

            $('#orderDetailsModal').modal('show');
        }

        function manageDelivery(orderId) {
            const order = orders.find(o => o.id === orderId);
            if (!order) return;

            const modalBody = document.getElementById('deliveryModalBody');
            
            if (order.deliveryMode === 'download') {
                modalBody.innerHTML = `
                    <div class="mb-3">
                        <h6 class="text-primary">Download Delivery Management</h6>
                        <p><strong>Order ID:</strong> ${order.id}</p>
                        <p><strong>Customer:</strong> ${order.customerName}</p>
                        <p><strong>Project:</strong> ${order.projectTitle}</p>
                    </div>
                    
                    <div class="form-group">
                        <label for="downloadLink">Download Link</label>
                        <input type="url" class="form-control" id="downloadLink" 
                               value="${order.downloadLink || ''}" 
                               placeholder="https://example.com/download/project">
                    </div>
                    
                    <div class="form-group">
                        <label>Link Status</label>
                        <div>
                            <span class="badge ${order.linkSent ? 'badge-success' : 'badge-warning'}">
                                ${order.linkSent ? 'Link Sent' : 'Link Pending'}
                            </span>
                        </div>
                    </div>
                    
                    <div class="delivery-actions">
                        <button class="btn btn-primary" onclick="generateDownloadLink('${order.id}')">
                            <i class="fas fa-link"></i> Generate Link
                        </button>
                        <button class="btn btn-success" onclick="sendLinkToCustomer('${order.id}')" 
                                ${!order.downloadLink ? 'disabled' : ''}>
                            <i class="fas fa-paper-plane"></i> Send Link to Customer
                        </button>
                        <button class="btn btn-info" onclick="copyDownloadLink('${order.id}')" 
                                ${!order.downloadLink ? 'disabled' : ''}>
                            <i class="fas fa-copy"></i> Copy Link
                        </button>
                    </div>
                `;
            } else {
                modalBody.innerHTML = `
                    <div class="mb-3">
                        <h6 class="text-primary">Pen Drive Delivery Management</h6>
                        <p><strong>Order ID:</strong> ${order.id}</p>
                        <p><strong>Customer:</strong> ${order.customerName}</p>
                        <p><strong>Project:</strong> ${order.projectTitle}</p>
                    </div>
                    
                    <div class="form-group">
                        <label for="trackingId">Tracking ID</label>
                        <input type="text" class="form-control" id="trackingId" 
                               value="${order.trackingId || ''}" 
                               placeholder="Enter tracking ID">
                    </div>
                    
                    <div class="form-group">
                        <label for="courierName">Courier Name</label>
                        <select class="form-control" id="courierName">
                            <option value="">Select Courier</option>
                            <option value="FedEx" ${order.courierName === 'FedEx' ? 'selected' : ''}>FedEx</option>
                            <option value="UPS" ${order.courierName === 'UPS' ? 'selected' : ''}>UPS</option>
                            <option value="DHL" ${order.courierName === 'DHL' ? 'selected' : ''}>DHL</option>
                            <option value="USPS" ${order.courierName === 'USPS' ? 'selected' : ''}>USPS</option>
                            <option value="Blue Dart" ${order.courierName === 'Blue Dart' ? 'selected' : ''}>Blue Dart</option>
                            <option value="Delhivery" ${order.courierName === 'Delhivery' ? 'selected' : ''}>Delhivery</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="dispatchDate">Dispatch Date</label>
                        <input type="date" class="form-control" id="dispatchDate" 
                               value="${order.dispatchDate || ''}">
                    </div>
                    
                    <div class="form-group">
                        <label>Current Status</label>
                        <div>
                            <span class="badge ${getStatusBadgeClass(order.status)}">
                                ${order.status.charAt(0).toUpperCase() + order.status.slice(1)}
                            </span>
                        </div>
                    </div>
                    
                    <div class="delivery-actions">
                        <button class="btn btn-warning" onclick="markAsShipped('${order.id}')">
                            <i class="fas fa-shipping-fast"></i> Mark as Shipped
                        </button>
                        <button class="btn btn-success" onclick="markAsDelivered('${order.id}')">
                            <i class="fas fa-check-circle"></i> Mark as Delivered
                        </button>
                        <button class="btn btn-info" onclick="printShippingLabel('${order.id}')">
                            <i class="fas fa-print"></i> Print Shipping Label
                        </button>
                        <button class="btn btn-danger" onclick="cancelOrder('${order.id}')">
                            <i class="fas fa-times"></i> Cancel Order
                        </button>
                    </div>
                `;
            }

            $('#deliveryModal').modal('show');
        }

        function updateStatus(orderId) {
            const order = orders.find(o => o.id === orderId);
            if (!order) return;

            const newStatus = prompt(`Update status for order ${orderId}:\n\nCurrent status: ${order.status}\n\nEnter new status (pending, processing, shipped, completed, cancelled):`);
            
            if (newStatus && ['pending', 'processing', 'shipped', 'completed', 'cancelled'].includes(newStatus.toLowerCase())) {
                order.status = newStatus.toLowerCase();
                renderOrders();
                alert(`Order ${orderId} status updated to: ${newStatus}`);
            } else if (newStatus) {
                alert('Invalid status. Please enter: pending, processing, shipped, completed, or cancelled');
            }
        }

        function updateOrderStatus() {
            const orderId = $('#orderDetailsModal').data('orderId');
            const adminNotes = document.getElementById('adminNotesTextarea').value;
            
            const order = orders.find(o => o.id === orderId);
            if (order) {
                order.adminNotes = adminNotes;
                alert('Order updated successfully!');
                $('#orderDetailsModal').modal('hide');
                renderOrders();
            }
        }

        function saveDeliveryDetails() {
            const orderId = $('#deliveryModal').data('orderId');
            const order = orders.find(o => o.id === orderId);
            
            if (!order) return;

            if (order.deliveryMode === 'download') {
                const downloadLink = document.getElementById('downloadLink').value;
                order.downloadLink = downloadLink;
                
                if (downloadLink) {
                    order.status = 'completed';
                }
            } else {
                const trackingId = document.getElementById('trackingId').value;
                const courierName = document.getElementById('courierName').value;
                const dispatchDate = document.getElementById('dispatchDate').value;
                
                order.trackingId = trackingId;
                order.courierName = courierName;
                order.dispatchDate = dispatchDate;
                
                if (trackingId && courierName && dispatchDate) {
                    order.status = 'shipped';
                }
            }

            $('#deliveryModal').modal('hide');
            renderOrders();
            alert('Delivery details updated successfully!');
        }

        // Download delivery functions
        function generateDownloadLink(orderId) {
            const order = orders.find(o => o.id === orderId);
            if (!order) return;

            const generatedLink = `https://downloads.example.com/projects/${orderId}/${order.projectTitle.replace(/\s+/g, '-').toLowerCase()}.zip`;
            order.downloadLink = generatedLink;
            document.getElementById('downloadLink').value = generatedLink;
            
            alert('Download link generated successfully!');
        }

        function sendLinkToCustomer(orderId) {
            const order = orders.find(o => o.id === orderId);
            if (!order || !order.downloadLink) return;

            order.linkSent = true;
            order.status = 'completed';
            
            alert(`Download link sent to ${order.email}!`);
            $('#deliveryModal').modal('hide');
            renderOrders();
        }

        function copyDownloadLink(orderId) {
            const order = orders.find(o => o.id === orderId);
            if (!order || !order.downloadLink) return;

            navigator.clipboard.writeText(order.downloadLink).then(() => {
                alert('Download link copied to clipboard!');
            }).catch(() => {
                alert('Failed to copy link. Please copy manually.');
            });
        }

        // Pen drive delivery functions
        function markAsShipped(orderId) {
            const order = orders.find(o => o.id === orderId);
            if (!order) return;

            const trackingId = document.getElementById('trackingId').value;
            const courierName = document.getElementById('courierName').value;
            const dispatchDate = document.getElementById('dispatchDate').value;

            if (!trackingId || !courierName || !dispatchDate) {
                alert('Please fill in all shipping details before marking as shipped.');
                return;
            }

            order.trackingId = trackingId;
            order.courierName = courierName;
            order.dispatchDate = dispatchDate;
            order.status = 'shipped';

            $('#deliveryModal').modal('hide');
            renderOrders();
            alert(`Order ${orderId} marked as shipped!`);
        }

        function markAsDelivered(orderId) {
            const order = orders.find(o => o.id === orderId);
            if (!order) return;

            order.status = 'completed';
            $('#deliveryModal').modal('hide');
            renderOrders();
            alert(`Order ${orderId} marked as delivered!`);
        }

        function printShippingLabel(orderId) {
            const order = orders.find(o => o.id === orderId);
            if (!order) return;

            // Create a simple shipping label content
            const labelContent = `
                <div style="font-family: Arial, sans-serif; padding: 20px; border: 2px solid #000; max-width: 400px;">
                    <h2>SHIPPING LABEL</h2>
                    <hr>
                    <p><strong>Order ID:</strong> ${order.id}</p>
                    <p><strong>Customer:</strong> ${order.customerName}</p>
                    <p><strong>Email:</strong> ${order.email}</p>
                    <p><strong>Phone:</strong> ${order.phone}</p>
                    <p><strong>Project:</strong> ${order.projectTitle}</p>
                    <p><strong>Tracking ID:</strong> ${order.trackingId || 'N/A'}</p>
                    <p><strong>Courier:</strong> ${order.courierName || 'N/A'}</p>
                    <p><strong>Dispatch Date:</strong> ${order.dispatchDate || 'N/A'}</p>
                    <hr>
                    <p><small>Handle with care - Contains Pen Drive</small></p>
                </div>
            `;

            const printWindow = window.open('', '_blank');
            printWindow.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <title>Shipping Label - ${order.id}</title>
                    <style>
                        body { margin: 0; padding: 20px; }
                        @media print {
                            body { margin: 0; }
                        }
                    </style>
                </head>
                <body>
                    ${labelContent}
                </body>
                </html>
            `);
            printWindow.document.close();
            printWindow.print();
        }

        function cancelOrder(orderId) {
            const order = orders.find(o => o.id === orderId);
            if (!order) return;

            const reason = prompt('Please enter the reason for cancellation:');
            if (reason) {
                order.status = 'cancelled';
                order.adminNotes = `Cancelled: ${reason}`;
                
                $('#deliveryModal').modal('hide');
                renderOrders();
                alert(`Order ${orderId} has been cancelled.`);
            }
        }

        function changePage(page) {
            const totalPages = Math.ceil(filteredOrders.length / ordersPerPage);
            if (page < 1 || page > totalPages) return;

            currentPage = page;
            renderOrders();
            updatePagination();
        }

        function updatePaginationInfo() {
            const startIndex = (currentPage - 1) * ordersPerPage + 1;
            const endIndex = Math.min(currentPage * ordersPerPage, filteredOrders.length);
            const total = filteredOrders.length;

            document.getElementById('paginationInfo').textContent = 
                `Showing ${startIndex} to ${endIndex} of ${total} entries`;

            updatePagination();
        }

        function updatePagination() {
            const totalPages = Math.ceil(filteredOrders.length / ordersPerPage);
            const pagination = document.getElementById('pagination');
            
            pagination.innerHTML = '';

            // Previous button
            const prevLi = document.createElement('li');
            prevLi.className = `page-item ${currentPage === 1 ? 'disabled' : ''}`;
            prevLi.innerHTML = `<a class="page-link" href="#" onclick="changePage(${currentPage - 1})">Previous</a>`;
            pagination.appendChild(prevLi);

            // Page numbers
            for (let i = 1; i <= totalPages; i++) {
                if (i === 1 || i === totalPages || (i >= currentPage - 1 && i <= currentPage + 1)) {
                    const pageLi = document.createElement('li');
                    pageLi.className = `page-item ${i === currentPage ? 'active' : ''}`;
                    pageLi.innerHTML = `<a class="page-link" href="#" onclick="changePage(${i})">${i}</a>`;
                    pagination.appendChild(pageLi);
                } else if (i === currentPage - 2 || i === currentPage + 2) {
                    const ellipsisLi = document.createElement('li');
                    ellipsisLi.className = 'page-item disabled';
                    ellipsisLi.innerHTML = '<span class="page-link">...</span>';
                    pagination.appendChild(ellipsisLi);
                }
            }

            // Next button
            const nextLi = document.createElement('li');
            nextLi.className = `page-item ${currentPage === totalPages ? 'disabled' : ''}`;
            nextLi.innerHTML = `<a class="page-link" href="#" onclick="changePage(${currentPage + 1})">Next</a>`;
            pagination.appendChild(nextLi);
        }

        // Store order ID in modal data for reference
        function viewOrderDetails(orderId) {
            const order = orders.find(o => o.id === orderId);
            if (!order) return;

            $('#orderDetailsModal').data('orderId', orderId);
            
            const modalBody = document.getElementById('orderDetailsBody');
            modalBody.innerHTML = `
                <div class="order-details-section">
                    <h6 class="text-primary">Order Information</h6>
                    <div class="row">
                        <div class="col-md-6">
                            <p><strong>Order ID:</strong> ${order.id}</p>
                            <p><strong>Order Date:</strong> ${formatDate(order.orderDate)}</p>
                            <p><strong>Status:</strong> 
                                <span class="badge ${getStatusBadgeClass(order.status)}">
                                    ${order.status.charAt(0).toUpperCase() + order.status.slice(1)}
                                </span>
                            </p>
                        </div>
                        <div class="col-md-6">
                            <p><strong>Project:</strong> ${order.projectTitle}</p>
                            <p><strong>Price:</strong> $${order.price}</p>
                            <p><strong>Delivery Mode:</strong> ${order.deliveryMode === 'download' ? 'Download' : 'Pen Drive'}</p>
                        </div>
                    </div>
                </div>

                <div class="order-details-section">
                    <h6 class="text-primary">Customer Information</h6>
                    <div class="row">
                        <div class="col-md-6">
                            <p><strong>Name:</strong> ${order.customerName}</p>
                            <p><strong>Email:</strong> ${order.email}</p>
                        </div>
                        <div class="col-md-6">
                            <p><strong>Phone:</strong> ${order.phone}</p>
                        </div>
                    </div>
                </div>

                <div class="order-details-section">
                    <h6 class="text-primary">Delivery Details</h6>
                    ${order.deliveryMode === 'download' ? 
                        `<p><strong>Download Link:</strong> ${order.downloadLink || 'Not generated'}</p>
                         <p><strong>Link Status:</strong> ${order.linkSent ? 'Sent' : 'Pending'}</p>` :
                        `<p><strong>Tracking ID:</strong> ${order.trackingId || 'Not assigned'}</p>
                         <p><strong>Courier:</strong> ${order.courierName || 'Not assigned'}</p>
                         <p><strong>Dispatch Date:</strong> ${order.dispatchDate ? formatDate(order.dispatchDate) : 'Not dispatched'}</p>`
                    }
                </div>

                <div class="order-details-section">
                    <h6 class="text-primary">Admin Notes</h6>
                    <p>${order.adminNotes || 'No notes available'}</p>
                    <textarea class="form-control" id="adminNotesTextarea" rows="3" placeholder="Add admin notes...">${order.adminNotes || ''}</textarea>
                </div>
            `;

            $('#orderDetailsModal').modal('show');
        }

        // Store order ID in delivery modal data for reference
        function manageDelivery(orderId) {
            $('#deliveryModal').data('orderId', orderId);
            
            const order = orders.find(o => o.id === orderId);
            if (!order) return;

            const modalBody = document.getElementById('deliveryModalBody');
            
            if (order.deliveryMode === 'download') {
                modalBody.innerHTML = `
                    <div class="mb-3">
                        <h6 class="text-primary">Download Delivery Management</h6>
                        <p><strong>Order ID:</strong> ${order.id}</p>
                        <p><strong>Customer:</strong> ${order.customerName}</p>
                        <p><strong>Project:</strong> ${order.projectTitle}</p>
                    </div>
                    
                    <div class="form-group">
                        <label for="downloadLink">Download Link</label>
                        <input type="url" class="form-control" id="downloadLink" 
                               value="${order.downloadLink || ''}" 
                               placeholder="https://example.com/download/project">
                    </div>
                    
                    <div class="form-group">
                        <label>Link Status</label>
                        <div>
                            <span class="badge ${order.linkSent ? 'badge-success' : 'badge-warning'}">
                                ${order.linkSent ? 'Link Sent' : 'Link Pending'}
                            </span>
                        </div>
                    </div>
                    
                    <div class="delivery-actions">
                        <button class="btn btn-primary" onclick="generateDownloadLink('${order.id}')">
                            <i class="fas fa-link"></i> Generate Link
                        </button>
                        <button class="btn btn-success" onclick="sendLinkToCustomer('${order.id}')" 
                                ${!order.downloadLink ? 'disabled' : ''}>
                            <i class="fas fa-paper-plane"></i> Send Link to Customer
                        </button>
                        <button class="btn btn-info" onclick="copyDownloadLink('${order.id}')" 
                                ${!order.downloadLink ? 'disabled' : ''}>
                            <i class="fas fa-copy"></i> Copy Link
                        </button>
                    </div>
                `;
            } else {
                modalBody.innerHTML = `
                    <div class="mb-3">
                        <h6 class="text-primary">Pen Drive Delivery Management</h6>
                        <p><strong>Order ID:</strong> ${order.id}</p>
                        <p><strong>Customer:</strong> ${order.customerName}</p>
                        <p><strong>Project:</strong> ${order.projectTitle}</p>
                    </div>
                    
                    <div class="form-group">
                        <label for="trackingId">Tracking ID</label>
                        <input type="text" class="form-control" id="trackingId" 
                               value="${order.trackingId || ''}" 
                               placeholder="Enter tracking ID">
                    </div>
                    
                    <div class="form-group">
                        <label for="courierName">Courier Name</label>
                        <select class="form-control" id="courierName">
                            <option value="">Select Courier</option>
                            <option value="FedEx" ${order.courierName === 'FedEx' ? 'selected' : ''}>FedEx</option>
                            <option value="UPS" ${order.courierName === 'UPS' ? 'selected' : ''}>UPS</option>
                            <option value="DHL" ${order.courierName === 'DHL' ? 'selected' : ''}>DHL</option>
                            <option value="USPS" ${order.courierName === 'USPS' ? 'selected' : ''}>USPS</option>
                            <option value="Blue Dart" ${order.courierName === 'Blue Dart' ? 'selected' : ''}>Blue Dart</option>
                            <option value="Delhivery" ${order.courierName === 'Delhivery' ? 'selected' : ''}>Delhivery</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="dispatchDate">Dispatch Date</label>
                        <input type="date" class="form-control" id="dispatchDate" 
                               value="${order.dispatchDate || ''}">
                    </div>
                    
                    <div class="form-group">
                        <label>Current Status</label>
                        <div>
                            <span class="badge ${getStatusBadgeClass(order.status)}">
                                ${order.status.charAt(0).toUpperCase() + order.status.slice(1)}
                            </span>
                        </div>
                    </div>
                    
                    <div class="delivery-actions">
                        <button class="btn btn-warning" onclick="markAsShipped('${order.id}')">
                            <i class="fas fa-shipping-fast"></i> Mark as Shipped
                        </button>
                        <button class="btn btn-success" onclick="markAsDelivered('${order.id}')">
                            <i class="fas fa-check-circle"></i> Mark as Delivered
                        </button>
                        <button class="btn btn-info" onclick="printShippingLabel('${order.id}')">
                            <i class="fas fa-print"></i> Print Shipping Label
                        </button>
                        <button class="btn btn-danger" onclick="cancelOrder('${order.id}')">
                            <i class="fas fa-times"></i> Cancel Order
                        </button>
                    </div>
                `;
            }

            $('#deliveryModal').modal('show');
        }

    </script>

    <!-- Bootstrap core JavaScript-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/4.6.0/js/bootstrap.bundle.min.js"></script>

    <!-- Core plugin JavaScript-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.4.1/jquery.easing.min.js"></script>

</body>

</html>